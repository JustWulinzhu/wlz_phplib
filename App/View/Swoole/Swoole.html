<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Swoole Test</title>
</head>

<body>

<textarea id="content" rows="3" style="width: 200px;"></textarea>
<br/>
<input type="submit" value="发送" style="height: 40px;width: 80px;display: inline-block;" onclick="send()">
<div id="msg"></div>

</body>

<script>

    var msg = document.getElementById("msg");
    var wsServer = 'ws://39.105.182.40:9502';
    //调用websocket对象建立连接：
    //参数：ws/wss(加密)：//ip:port （字符串）
    var websocket = new WebSocket(wsServer);
    //onopen监听连接打开
    websocket.onopen = function (evt) {
        //websocket.readyState 属性：
        /*
        CONNECTING    0    The connection is not yet open.
        OPEN    1    The connection is open and ready to communicate.
        CLOSING    2    The connection is in the process of closing.
        CLOSED    3    The connection is closed or couldn't be opened.
        */
        msg.innerHTML = websocket.readyState;
    };

    function send(){
        var text = document.getElementById('content').value;
        document.getElementById('content').value = '';
        //向服务器发送数据
        websocket.send(text);
    }

    //onclose 监听连接关闭
    websocket.onclose = function (evt) {
        msg.innerHTML += '断开连接' + '<br>';
    };

    //onmessage 监听服务器数据推送
    websocket.onmessage = function (evt) {
        msg.innerHTML += evt.data + '<br>';
    };
    //监听连接错误信息
    //    websocket.onerror = function (evt, e) {
    //        console.log('Error occured: ' + evt.data);
    //    };

</script>
</html>